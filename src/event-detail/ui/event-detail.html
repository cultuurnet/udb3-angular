<div ng-if="eventIdIsInvalid">
  <div class="page-header">
    <h1>{{::translateEventDetail('not_found')}}</h1>
  </div>

  <div class="row">
    <div class="col-xs-12">
      <p>{{::translateEventDetail('not_found_help')}}</p>
    </div>
  </div>
</div>

<div ng-if="!finishedLoading()">
  <p class="title"><span class="placeholder-title"></span></p>
  <p class="text-center"><i class="fa fa-circle-o-notch fa-spin fa-fw"></i><span class="sr-only">{{::translateEventDetail('loading')}}</span></p>
</div>

<div ng-if="finishedLoading()" class="event-detail">
  <h1 class="title" ng-bind="::event.name"></h1>
  <div class="row">
    <div class="col-sm-3 col-sm-push-9">
      <div class="list-group" ng-if="::permissions">
        <button ng-if="::permissions.editing"
                class="list-group-item"
                type="button"
                ng-click="openEditPage()"><i class="fa fa-pencil" aria-hidden="true"></i>  {{::translateEventDetail('edit')}}</button>
        <button ng-if="::permissions.duplication"
                class="list-group-item"
                type="button"
                ui-sref='duplication.event(::{id: event.id})'><i class="fa fa-files-o" aria-hidden="true"></i>  {{::translateEventDetail('duplicate')}}</button>
        <button ng-if="::permissions.editing"
                class="list-group-item"
                href="#"
                ng-click="deleteEvent()"><i class="fa fa-trash" aria-hidden="true"></i>  {{::translateEventDetail('delete')}}</button>
        <udb-moderation-offer ng-if="::moderationPermission" class="list-group-item moderation-detail" offer-id="{{::event['@id']}}" continue="true"></udb-moderation-offer>
      </div>
    </div>
    <div class="col-sm-9 col-sm-pull-3">
      <ul class="nav nav-tabs">
        <li ng-repeat="tab in tabs" ng-class="{active: isTabActive(tab.id)}" role="tab">
          <a ng-click="makeTabActive(tab.id)" role="tab" ng-bind="tab.header" href="#"></a>
        </li>
      </ul>

      <div class="tab-pane" role="tabpanel" ng-show="isTabActive('data')">
          <table class="table udb3-data-table">
            <colgroup>
              <col style="width:20%"/>
              <col style="width:80%"/>
            </colgroup>
            <tbody>
              <tr>
                <td><span class="row-label">{{::translateEventDetail('title')}}</span></td>
                <td>{{::event.name}}</td>
              </tr>
              <tr>
                <td><span class="row-label">{{::translateEventDetail('type')}}</span></td>
                <td>{{::event.type.label}}</td>
              </tr>
              <tr ng-if="::event.audience.audienceType !== 'everyone'">
                <td><span class="row-label">Toegang</span></td>
                <td>{{::translateAudience(event.audience.audienceType)}}
                <udb-event-cultuurkuur-component event="event" permission="::permissions.editing" ></udb-event-cultuurkuur-component></td>
              </tr>
              <tr>
                <td>
                  <span class="row-label">{{::translateEventDetail('labels')}}</span>
                </td>
                <td>
                  <p>
                    <udb-label-select labels="::event.labels"
                                    label-added="labelAdded(label)"
                                    label-removed="labelRemoved(label)">
                    </udb-label-select>
                  </p>
                  <p ng-if="labelResponse === 'error'" class="alert alert-danger">
                    <span translate="preview.labels_error" translate-values="{ labelName: '{{labelsError.name}}' }"></span>
                  </p>
                  <p ng-if="labelResponse === 'success'" class="alert alert-success">
                    <span translate="preview.labels_success" translate-values="{ addedLabel: '{{addedLabel}}' }"></span>
                  </p>
                  <p ng-if="labelResponse === 'unlabelError'" class="alert alert-danger">
                    <span ng-bind="labelsError"></span>
                  </p>
                </td>
              </tr>
              <tr ng-class="::{muted: isEmpty(event.description)}">
                <td><span class="row-label">{{::translateEventDetail('description')}}</span></td>
                <td ng-if="::(!isEmpty(event.description))">
                  <div ng-bind-html="::event.description" class="event-detail-description"></div>
                </td>
                <td ng-if="::(isEmpty(event.description))">
                  {{::translateEventDetail('no_description')}}
                </td>
              </tr>
              <tr>
                <td><span class="row-label">{{::translateEventDetail('where')}}</span></td>
                <td ng-show="::event.location.url"><a ui-sref="split.footer.place-preview({id: event.location.id})">{{eventLocation(event)}}</a></td>
                <td ng-hide="::event.location.url">
                  {{eventLocation(event)}}
                </td>
              </tr>
              <tr>
                <td><span class="row-label">{{::translateEventDetail('when')}}</span></td>
                <td>
                  <span ng-if="::calendarSummary" ng-bind-html="::calendarSummary"></span>
                  <span class="text-muted"
                        ng-if="::(calendarSummary !== undefined ? (calendarSummary === false) : undefined)">
                      Probleem bij het ophalen van de kalenderinformatie
                    </span>
                </td>
              </tr>
              <tr ng-class="::{muted: (!event.organizer)}">
                <td><span class="row-label">{{::translateEventDetail('organizer')}}</span></td>
                <td ng-if="::event.organizer">{{::event.organizer.name}}</td>
                <td ng-if="::(!event.organizer)">
                  {{::translateEventDetail('no_organizer')}}
                </td>
              </tr>
              <tr class="rv-event-info-price" ng-class="::{muted: !event.priceInfo.length}">
                <td><span class="row-label">{{::translateEventDetail('price')}}</span></td>
                <td ng-if="::event.priceInfo.length">
                  <table class="table table-bordered event-detail-price-table">
                    <tr ng-repeat="priceInfo in ::event.priceInfo">
                      <td>{{priceInfo.name}}</td>
                      <td>
                        <span ng-if="priceInfo.price == 0">
                          {{::translateEventDetail('free')}}
                        </span>
                        <span ng-if="::priceInfo.price != 0">
                          {{priceInfo.price | currency}} {{::translateEventDetail('currency')}}
                        </span>
                      </td>
                    </tr>
                  </table>
                </td>
                <td ng-if="::(event.priceInfo.length == 0)">
                  {{::translateEventDetail('no_price')}}
                </td>
              </tr>
            </tbody>
            <tbody ng-if="::(!isEmpty(event.bookingInfo))" udb-booking-info-detail="::event.bookingInfo"></tbody>
            <tbody udb-contact-point-detail="::event.contactPoint"></tbody>
            <tbody>
              <tr  ng-class="::{muted: noAgeInfo}">
                <td><span class="row-label">{{::translateEventDetail('age_label')}}</span></td>
                <td>
                  <span ng-if="::!allAges && !noAgeInfo">{{event.typicalAgeRange}}</span>
                  <span ng-if="::allAges && !noAgeInfo">{{::translateEventDetail('all_ages')}}</span>
                  <span ng-if="noAgeInfo">{{::translateEventDetail('no_age')}}</span>
                </td>

              </tr>
            </tbody>
            <tbody udb-image-detail="::event.mediaObject" image="::event.image"></tbody>
          </table>
      </div>

      <div role="tabpanel" class="tab-pane" ng-show="isTabActive('history')">
        <div class="timeline">
          <p ng-show="!eventHistory" class="text-center">
            <i class="fa fa-circle-o-notch fa-spin fa-fw"></i><span class="sr-only">{{::translateEventDetail('loading')}}</span>
          </p>
          <div ng-if="::eventHistory">
            <dl ng-repeat="eventAction in ::eventHistory track by $index">
              <dt ng-bind="::eventAction.date | date:'dd/MM/yyyy H:mm'"></dt>
              <dd>
                <span class="author" ng-if="eventAction.author" ng-bind="::eventAction.author"></span>
                <br ng-if="::eventAction.author"/>
                <span class="description" ng-bind="::eventAction.description"></span>
              </dd>
            </dl>
          </div>
        </div>
      </div>

      <div class="tab-pane" role="tabpanel" ng-show="isTabActive('publication')">
        <table class="table udb3-data-table">
          <colgroup>
            <col style="width:20%"/>
            <col style="width:80%"/>
          </colgroup>
          <tbody udb-workflow-status="::event">
          </tbody>
        </table>
      </div>

    </div>
  </div>
</div>
